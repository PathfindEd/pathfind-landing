---
layout: default
title: Personalised Study Abroad Assessment
permalink: /consultation/
---

<div class="form-container">
    <h1 class="form-header-title">Personalised Study Abroad Assessment</h1>
    <p class="form-header-tagline">
        Pathfind Education offers free, honest advice to help students apply to universities in the UK, USA, Australia, Canada, and New Zealand.
    </p>

    <form name="consultation" method="POST" action="https://consultation-handler.wild-morning-134b.workers.dev/" enctype="multipart/form-data">
        <input type="hidden" name="form-name" value="consultation">
        
        <div id="progress-indicator">
            <span class="step active" id="step-1">1</span>
            <span class="step" id="step-2">2</span>
            <span class="step" id="step-3">3</span>
            <span class="step" id="step-4">4</span>
        </div>
        
        <fieldset class="form-page" id="page-1">
            <legend>Step 1: Personal Contact Details</legend>
            
            <label for="full_name">Full Name <span class="required-star">*</span></label>
            <input type="text" id="full_name" name="full_name" placeholder="E.g., John Smith" required>

            <label for="email">Email <span class="required-star">*</span></label>
            <input type="email" id="email" name="email" placeholder="E.g., yourname@email.com" required>
            
            <label for="whatsapp_number">WhatsApp Number (with country code) <span class="required-star">*</span></label>
            <input type="tel" id="whatsapp_number" name="whatsapp_number" placeholder="E.g., +447836123456" pattern="^\+?[0-9\s]{8,15}$" required>
            
            <label for="city_country">Current City & Country <span class="required-star">*</span></label>
            <input type="text" id="city_country" name="city_country" placeholder="E.g., London, UK or Dubai, UAE" required>

            <label for="date_of_birth">Date of Birth <span class="required-star">*</span></label>
            <input type="date" id="date_of_birth" name="date_of_birth" required>

            <div class="nav-buttons" style="justify-content: flex-end;">
                <button type="button" class="accent-button next-button">Next Step &rarr;</button>
            </div>
        </fieldset>

        <fieldset class="form-page hidden" id="page-2">
            <legend>Step 2: Academic Background</legend>
            
            <label>What is the highest qualification you have completed? <span class="required-star">*</span></label>
            <div class="radio-group" id="qual-group">
                <label><input type="radio" name="highest_qualification" value="O Levels / iGCSE/ 10th Grade" required> O Levels / iGCSE / 10th Grade</label>
                <label><input type="radio" name="highest_qualification" value="A Levels / 12th Grade" required> A Levels / 12th Grade - FA / FSc / ICS / ICom</label>
                <label><input type="radio" name="highest_qualification" value="Foundation/Pathway" required> Foundation/Pathway Programme</label>
                <label><input type="radio" name="highest_qualification" value="Bachelor’s Degree" required> Bachelor’s Degree</label>
                <label><input type="radio" name="highest_qualification" value="Master’s Degree" required> Master’s Degree</label>
                <label>
                    <input type="radio" name="highest_qualification" value="Other Qualification" required data-show-input="other_qual_input">
                    Other Qualification:
                </label>
            </div>
            <input type="text" id="other_qual_input" name="other_qualification_details" placeholder="Please specify your qualification" class="optional-input hidden" disabled>

            <label for="full_course_name">What was the full course name? <span class="required-star">*</span></label>
            <input type="text" id="full_course_name" name="full_course_name" placeholder="E.g., Bachelor of Arts in History" required>

            <label for="completion_details">Completion Year and Grade Achieved or Predicted <span class="required-star">*</span></label>
            <input type="text" id="completion_details" name="completion_details" placeholder="E.g., 2024, 3.5 GPA or Predicted ABB" required>

            <div class="nav-buttons">
                <button type="button" class="dark-button prev-button">&larr; Previous</button>
                <button type="button" class="accent-button next-button">Next Step &rarr;</button>
            </div>
        </fieldset>
        
        <fieldset class="form-page hidden" id="page-3">
            <legend>Step 3: Study Preferences & Goals</legend>
            
            <label>Which course level do you plan to study? <span class="required-star">*</span></label>
            <div class="radio-group" id="course-group">
                <label><input type="radio" name="course_level" value="Undergraduate (Bachelor’s)" required> Undergraduate (Bachelor’s)</label>
                <label><input type="radio" name="course_level" value="Postgraduate (Master’s)" required> Postgraduate (Master’s)</label>
                <label><input type="radio" name="course_level" value="PhD / Research" required> PhD / Research</label>
                <label><input type="radio" name="course_level" value="Not Sure Yet" required> Not Sure Yet</label>
            </div>

            <label for="target_subject">Target Subject of Study <span class="required-star">*</span></label>
            <input type="text" id="target_subject" name="target_subject" placeholder="E.g., Computer Science, Business Administration" required>

            <label for="target_countries">Which country/countries do you want to study in? <span class="required-star">*</span></label>
            <input type="text" id="target_countries" name="target_countries" placeholder="E.g., UK, Canada, USA (list up to 3)" required>

            <label>Have you taken any English test? <span class="required-star">*</span></label>
            <div class="radio-group" id="english-test-group">
                <label><input type="radio" name="english_test_taken" value="IELTS" required data-show-score="true"> IELTS</label>
                <label><input type="radio" name="english_test_taken" value="PTE" required data-show-score="true"> PTE</label>
                <label><input type="radio" name="english_test_taken" value="TOEFL" required data-show-score="true"> TOEFL</label>
                <label><input type="radio" name="english_test_taken" value="Duolingo" required data-show-score="true"> Duolingo</label>
                <label><input type="radio" name="english_test_taken" value="Medium of Instruction (MOI)" required data-show-score="false"> MOI (Taught in English)</label>
                <label><input type="radio" name="english_test_taken" value="None Taken" required data-show-score="false"> None Taken / Will take if required</label>
            </div>

            <label for="english_test_score" id="english_test_score_label" class="hidden">Test Score: <span class="required-star">*</span></label>
            <input type="text" id="english_test_score" name="english_test_score" placeholder="E.g., IELTS 6.5, PTE 58" class="optional-input hidden" disabled>
            
            <label for="budget_range">Budget Range (Tuition + Living per year) <span class="required-star">*</span></label>
            <input type="text" id="budget_range" name="budget_range" placeholder="E.g., £25,000 - £35,000" required>

            <label>When do you plan to start studying abroad? <span class="required-star">*</span></label>
            <div class="radio-group" id="start-date-group">
                <label><input type="radio" name="target_start_date" value="May / July 2026" required> May / July 2026</label>
                <label><input type="radio" name="target_start_date" value="Sept / Oct 2026" required> Sept / Oct 2026</label>
                <label><input type="radio" name="target_start_date" value="Jan / Feb 2027" required> Jan / Feb 2027</label>
                <label><input type="radio" name="target_start_date" value="Later / Not sure yet" required> Later / Not sure yet</label>
            </div>

            <label>Have you had any previous application or visa refusals? <span class="required-star">*</span></label>
            <div class="radio-group" id="refusal-group">
                <label><input type="radio" name="previous_application_visa" value="No Refusals" required data-show-input="false"> No Refusals</label>
                <label><input type="radio" name="previous_application_visa" value="Yes - Details Required" required data-show-input="refusal_details_input"> Yes, I have had a refusal (Details required)</label>
            </div>
            <textarea id="refusal_details_input" name="refusal_details" rows="3" placeholder="Please provide details of the refusal(s) and date" class="optional-input hidden" disabled></textarea>

            <div class="nav-buttons">
                <button type="button" class="dark-button prev-button">&larr; Previous</button>
                <button type="button" class="accent-button next-button">Next Step &rarr;</button>
            </div>
        </fieldset>

        <fieldset class="form-page hidden" id="page-4">
            <legend>Step 4: Required Confidential Documents & Consent</legend>
            <p class="upload-note" style="color: var(--muted); font-size: 14px;">
                All files are stored securely and GDPR-compliant. Please upload **PDF or high-quality JPG/PNG** files only.
            </p>
            
            <label for="transcript_file" class="upload-label">Academic Transcripts (Mark Sheets) <span class="required-star">*</span></label>
            <input type="file" id="transcript_file" name="transcript_file" accept=".pdf,.jpg,.png" required>

            <label for="passport_id_file" class="upload-label">Passport/ID (Photo Page or Government ID) <span class="required-star">*</span></label>
            <input type="file" id="passport_id_file" name="passport_id_file" accept=".pdf,.jpg,.png" required>

            <hr style="margin: 20px 0;">
            
            <label for="data_processing_consent" id="consent-label" style="display: flex; align-items: flex-start;">
                <input type="checkbox" id="data_processing_consent" name="data_processing_consent" value="Yes, I confirm" required style="margin-top: 5px;">
                <span style="margin-left: 8px;">
                    I consent to Pathfind Education collecting and processing my data and documents for the purpose of university application and assessment, as per the <a href="/privacy.html" target="_blank" style="color: var(--primary); font-weight: 700;">Privacy Policy</a>. <span class="required-star">*</span>
                    <strong style="display: block; margin-top: 5px;">I Confirm</strong>
                </span>
            </label>

            <label for="marketing_consent" style="font-weight: 400; color: #333; margin-top: 15px; display: flex; align-items: flex-start;">
                <input type="checkbox" id="marketing_consent" name="marketing_consent" value="Yes, I consent" style="margin-top: 5px;">
                <span style="margin-left: 8px;">
                    (Optional) I consent to receiving occasional emails about study abroad opportunities and updates.
                </span>
            </label>
            <label for="additional_notes">Is there anything else you would like us to know?</label>
            <textarea id="additional_notes" name="additional_notes" rows="3" placeholder="E.g., I need help with accommodation, I have prior work experience, etc."></textarea>
            
            <label>Where did you hear about us? <span class="required-star">*</span></label>
            <div class="radio-group" id="referral-group">
                <label><input type="radio" name="referral_source" value="Google Search" required> Google Search</label>
                <label><input type="radio" name="referral_source" value="Facebook" required> Facebook / Instagram</label>
                <label><input type="radio" name="referral_source" value="TikTok / YouTube" required> TikTok / YouTube</label>
                <label><input type="radio" name="referral_source" value="WhatsApp / Telegram" required> WhatsApp / Telegram</label>
                <label><input type="radio" name="referral_source" value="Family / Friends" required> Family / Friends (Referral)</label>
                <label>
                    <input type="radio" name="referral_source" value="Other Referral" required data-show-input="other_referral_input">
                    Other:
                </label>
            </div>
            <input type="text" id="other_referral_input" name="other_referral_details" placeholder="Please specify: E.g., University Event, Career Fair" class="optional-input hidden" disabled>
            
            <div class="nav-buttons">
                <button type="button" class="dark-button prev-button">&larr; Previous</button>
                <button type="submit" class="submit-button" id="final-submit-button">Submit & Get Expert Advice</button>
            </div>
        </fieldset>

    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.querySelector('form[name="consultation"]');
        const fieldsets = document.querySelectorAll('.form-page');
        const steps = document.querySelectorAll('.step');
        const submitButton = document.getElementById('final-submit-button');
        let currentPage = 1;

        if (!form || fieldsets.length === 0 || steps.length === 0) {
            console.error("Form initialization failed: Missing elements.");
            return;
        }

        // --- Helper Functions ---

        function updateFormDisplay() {
            fieldsets.forEach((fieldset, index) => {
                const isCurrent = index + 1 === currentPage;
                fieldset.classList.toggle('hidden', !isCurrent);

                fieldset.querySelectorAll('[data-original-required]').forEach(input => {
                    if (isCurrent) {
                        if (!input.classList.contains('optional-input')) {
                            input.setAttribute('required', 'required');
                        }
                    } else {
                        input.removeAttribute('required');
                    }
                });
            });

            steps.forEach((step, index) => {
                step.classList.toggle('active', index + 1 <= currentPage);
            });

            const formContainer = document.querySelector('.form-container');
            if (formContainer) {
                formContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function handleConditionalInputs(fieldset) {
            // 1. Reset all optional/conditional inputs (remove required attribute)
            fieldset.querySelectorAll('.optional-input').forEach(input => {
                input.classList.add('hidden');
                // Use property assignment for boolean states like 'disabled'
                input.disabled = true; 
                input.removeAttribute('required'); // Crucial: Remove required when hidden/disabled
            });
            
            // 2. Handle 'Other' Text Inputs (Add required attribute when shown)
            fieldset.querySelectorAll('input[type="radio"]:checked[data-show-input]').forEach(radio => {
                const targetId = radio.getAttribute('data-show-input');
                if (targetId && targetId !== 'false') {
                    const targetInput = document.getElementById(targetId);
                    if (targetInput) {
                        targetInput.classList.remove('hidden');
                        targetInput.disabled = false; // Use property assignment
                        targetInput.setAttribute('required', 'required'); // Set required
                    }
                }
            });

            // 3. Handle English Test Score Input (Page 3) (Fix skipping issue)
            const scoreLabel = document.getElementById('english_test_score_label');
            const scoreInput = document.getElementById('english_test_score');
            const checkedEnglishTest = fieldset.querySelector('input[name="english_test_taken"]:checked');

            if (scoreInput && scoreLabel) {
                const showScore = checkedEnglishTest && checkedEnglishTest.getAttribute('data-show-score') === 'true';
                
                scoreLabel.classList.toggle('hidden', !showScore);
                scoreInput.classList.toggle('hidden', !showScore);
                
                // IMPORTANT FIX: Use property assignment for disabled state
                scoreInput.disabled = !showScore; 
                
                // Ensure the required attribute is enforced ONLY when visible.
                if (showScore) {
                    // FIX FOR SKIP ISSUE: The required attribute needs to be set here
                    scoreInput.setAttribute('required', 'required');
                } else {
                    scoreInput.removeAttribute('required');
                }
            }
        }

        function validateCurrentPage(fieldset) {
            let isValid = true;
            let firstInvalidElement = null;
            
            // Clear previous error styles
            fieldset.querySelectorAll('.radio-group, #consent-label').forEach(el => {
                el.style.border = '';
                el.style.backgroundColor = '';
            });
            fieldset.querySelectorAll('input:not([type="radio"]):not([type="checkbox"]), textarea').forEach(input => {
                input.style.borderColor = '';
            });

            fieldset.querySelectorAll('[required]').forEach(input => {
                // Skip validation for hidden or disabled inputs, even if they have the 'required' attribute (conditional fields)
                if (input.classList.contains('hidden') || input.disabled) return;

                let isInputValid = true;

                if (input.type === 'radio') {
                    const radioName = input.name;
                    // Only check validation for the first radio input of a group (to prevent redundant checks)
                    if (fieldset.querySelector(`input[name="${radioName}"]`) !== input) return; 
                    
                    if (!fieldset.querySelector(`input[name="${radioName}"]:checked`)) {
                        isInputValid = false;
                    }
                } else if (input.type === 'checkbox') {
                    if (!input.checked) {
                       isInputValid = false;
                    }
                } else if (!input.checkValidity()) {
                    isInputValid = false;
                }

                if (!isInputValid) {
                    isValid = false;
                    if (!firstInvalidElement) firstInvalidElement = input;

                    if (input.type === 'checkbox' && input.id === 'data_processing_consent') {
                        // Special handling for the consent label wrapper
                        const consentLabel = document.getElementById('consent-label');
                        consentLabel.style.backgroundColor = 'rgba(255, 0, 0, 0.1)';
                        consentLabel.style.border = '1px solid red';
                    } else if (input.type === 'radio') {
                        // Special handling for radio groups
                        const radioGroup = input.closest('.radio-group');
                        if (radioGroup) {
                            radioGroup.style.border = '1px solid red';
                        }
                    } else {
                        // Default input styling
                        input.style.borderColor = 'red';
                    }
                }
            });
            
            if (firstInvalidElement) {
                // Scroll to the first invalid element or its containing group/label
                let scrollTarget = firstInvalidElement;
                if (firstInvalidElement.type === 'radio') {
                    scrollTarget = firstInvalidElement.closest('.radio-group');
                } else if (firstInvalidElement.id === 'data_processing_consent') {
                    scrollTarget = document.getElementById('consent-label');
                }
                if (scrollTarget) scrollTarget.scrollIntoView({ behavior: 'smooth', block: 'center' });

                // Use native reportValidity for visual feedback on standard inputs
                if (firstInvalidElement.type !== 'radio' && firstInvalidElement.reportValidity) {
                    firstInvalidElement.reportValidity();
                }
            }
            
            return isValid;
        }

        // --- Event Listeners ---

        form.addEventListener('click', function(event) {
            const target = event.target;
            const currentFieldset = fieldsets[currentPage - 1];

            if (target.classList.contains('next-button')) {
                event.preventDefault();
                if (validateCurrentPage(currentFieldset)) {
                    if (currentPage < fieldsets.length) {
                        currentPage++;
                        updateFormDisplay();
                        handleConditionalInputs(fieldsets[currentPage - 1]);
                    }
                }
            } else if (target.classList.contains('prev-button')) {
                event.preventDefault();
                if (currentPage > 1) {
                    currentPage--;
                    updateFormDisplay();
                    handleConditionalInputs(fieldsets[currentPage - 1]);
                }
            }
        });

        // Handle radio/checkbox group changes to trigger conditional inputs display/validation state update
        form.addEventListener('change', function(event) {
            const target = event.target;
            const currentFieldset = fieldsets[currentPage - 1];

            if (target.type === 'radio' && (target.hasAttribute('data-show-input') || target.hasAttribute('data-show-score'))) {
                handleConditionalInputs(currentFieldset);
            }
            
            // Clear error styling on change
            if (target.type === 'radio' && target.closest('.radio-group')) {
                const radioGroup = target.closest('.radio-group');
                radioGroup.style.border = '';
            }
             if (target.id === 'data_processing_consent' && target.checked) {
                const consentLabel = document.getElementById('consent-label');
                consentLabel.style.backgroundColor = '';
                consentLabel.style.border = '';
            }
        });

        form.addEventListener('submit', function(event) {
            const currentFieldset = fieldsets[currentPage - 1];
            
            if (!validateCurrentPage(currentFieldset)) {
                event.preventDefault();
            } else {
                submitButton.disabled = true;
                submitButton.textContent = 'Submitting... Please wait.';
                submitButton.classList.add('submitting');
            }
        });

        // Initial setup: Mark all required inputs for later restoration and show first page
        fieldsets.forEach(fieldset => {
            fieldset.querySelectorAll('[required]').forEach(input => {
                input.setAttribute('data-original-required', 'true');
            });
        });
        updateFormDisplay();
        handleConditionalInputs(fieldsets[currentPage - 1]);
    });
</script>
